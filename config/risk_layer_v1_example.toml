# =============================================================================
# Peak_Trade Risk Layer v1 - Config Example
# =============================================================================
# Portfolio-Level Risk Management mit VaR/CVaR und Stress-Testing
#
# Usage:
#   1. Kopiere diese Datei nach config/config.toml oder merge die [risk] Section
#   2. Passe die Limits an deine Risk-Toleranz an
#   3. Nutze build_risk_manager_from_config(cfg) im Backtest
#
# Documentation:
#   - src/risk/ enth채lt alle Module (types, portfolio, var, stress, enforcement)
#   - src/core/risk.py enth채lt PortfolioVaRStressRiskManager
#   - BacktestEngine nutzt RiskManager automatisch (wenn risk_manager=... gesetzt)
# =============================================================================

[risk]
# Risk Manager Type:
# - "noop": Keine Risk-Checks (Default)
# - "max_drawdown": Stoppt Trading bei Max-Drawdown
# - "equity_floor": Stoppt Trading bei Equity-Unterschreitung
# - "portfolio_var_stress": VaR/CVaR + Exposure-Limits (v1 Layer)
type = "portfolio_var_stress"

# VaR/CVaR Parameter
alpha = 0.05      # Konfidenzniveau (0.05 = 95% VaR/CVaR)
window = 252      # Rolling-Window f체r Returns (252 = ~1 Jahr Trading Days)

# Risk Limits (alle optional, None = nicht gepr체ft)
[risk.limits]
# Exposure Limits (als Fraction of Equity)
max_gross_exposure = 1.5    # Max Gross Exposure: 150% of Equity
max_net_exposure = 1.0      # Max Abs(Net Exposure): 100% of Equity

# Position Weight Limits
max_position_weight = 0.35  # Max 35% of Equity in einer Position

# VaR/CVaR Limits (als Fraction of Equity)
max_var = 0.08              # Max VaR(95%): 8% of Equity
max_cvar = 0.12             # Max CVaR(95%): 12% of Equity

# Correlation Limits (TODO: Multi-Asset-Support)
# max_corr = 0.95           # Max pairwise Correlation


# =============================================================================
# Alternative Configs (uncomment to use)
# =============================================================================

# --- Config 1: Conservative (Low Risk) ---
# [risk]
# type = "portfolio_var_stress"
# alpha = 0.01           # 99% VaR (extremer Tail)
# window = 252
# [risk.limits]
# max_gross_exposure = 1.0
# max_position_weight = 0.20
# max_var = 0.05
# max_cvar = 0.08

# --- Config 2: Aggressive (High Risk) ---
# [risk]
# type = "portfolio_var_stress"
# alpha = 0.10           # 90% VaR (weniger konservativ)
# window = 126           # 6 Monate
# [risk.limits]
# max_gross_exposure = 2.0
# max_position_weight = 0.50
# max_var = 0.15
# max_cvar = 0.20

# --- Config 3: Legacy Max-Drawdown-Only ---
# [risk]
# type = "max_drawdown"
# max_drawdown = 0.20    # 20% Max Drawdown (conservative default)


# =============================================================================
# Integration mit Backtest-Engine
# =============================================================================
#
# Option A: Config-basiert (empfohlen)
# -------------------------------------
# from src.core.peak_config import load_config
# from src.core.risk import build_risk_manager_from_config
# from src.backtest.engine import BacktestEngine
#
# cfg = load_config()
# risk_manager = build_risk_manager_from_config(cfg)
# engine = BacktestEngine(risk_manager=risk_manager)
# result = engine.run_realistic(df, strategy_fn, params)
#
# Option B: Programmatisch
# -------------------------
# from src.core.risk import PortfolioVaRStressRiskManager
#
# risk_manager = PortfolioVaRStressRiskManager(
#     alpha=0.05,
#     window=252,
#     max_gross_exposure=1.5,
#     max_var=0.08
# )
# engine = BacktestEngine(risk_manager=risk_manager)
#
# =============================================================================
