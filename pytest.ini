[pytest]
# Peak_Trade pytest Konfiguration (Phase 68)
# ============================================
#
# Warning-Filter für v1.0 Hardening
# - Eigene Warnungen: Beheben oder explizit labeln
# - Externe Library-Warnungen: Gezielt filtern, nicht global unterdrücken

# Test-Discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Output-Optionen
addopts =
    -v
    --strict-markers
    --tb=short

# Marker-Definitionen
markers =
    smoke: Fast smoke tests for CI/CD pipelines (< 10s total)
    slow: Langsame Tests (können mit -m "not slow" übersprungen werden)
    integration: Integration-Tests
    live: Tests die Live/Testnet-Komponenten benötigen
    requires_api: Tests die externe APIs benötigen
    requires_fastapi: Tests die FastAPI benötigen (optional dependency)
    requires_matplotlib: Tests die Matplotlib benötigen (optional dependency)
    requires_scipy: Tests die SciPy benötigen (optional dependency)
    requires_optional: Tests die optionale Dependencies benötigen (Catch-All)
    smoke: Fast smoke tests for CI gate (<5s total, critical path only)
    web: Tests that require the FastAPI/web stack (install with: uv sync --extra web)

# Warning-Filter
# ==============
# Gezielte Filter für bekannte Warnungen
# KEINE Catch-All-Filter ohne Begründung!
#
# v1.0 Hardening (Phase 68):
# - Pandas FutureWarnings für fillna() downcasting - bekannte Deprecation
# - Pytest Collection Warnings für Klassen mit "Test" Präfix + __init__
# - NumPy DeprecationWarnings (externe Library)
#
# Eigene Warnungen sollten NICHT gefiltert werden

filterwarnings =
    # Pandas FutureWarnings für fillna downcasting in Strategy-Code
    # Tracked in TECH_DEBT_BACKLOG.md - wird bei pandas 3.0 Migration behoben
    ignore:Downcasting object dtype arrays:FutureWarning:src.strategies.*

    # Pandas FutureWarnings generell
    ignore::FutureWarning:pandas.*

    # NumPy DeprecationWarnings (bekannt, werden in zukünftigen NumPy-Versionen behoben)
    ignore::DeprecationWarning:numpy.*

    # Pytest Collection Warnings für Klassen mit "Test" Präfix + __init__
    ignore:cannot collect test class:pytest.PytestCollectionWarning

    # Default: Alle anderen Warnungen anzeigen
    default

# Test-Timeouts (optional, falls timeout-Plugin installiert ist)
# timeout = 300
